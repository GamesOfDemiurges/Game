<!DOCTYPE html>
<!--[if IE 8]>         <html class="js ie8"> <![endif]-->
<!--[if IE 9]>         <html class="js ie9"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="js"> <!--<![endif]-->
	<head>
		<title>Игры Демиургов</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=0.5, user-scalable=no"/>

		<!--<link rel="stylesheet" type="text/css" href="css/style.css" media="screen, projection, print">
		<script type="text/javascript" src="js/main.js"></script> -->

		<style type="text/css">
			/* canvas { -webkit-transform: scale3d(2, 2, 0) translate3d(200px, 110px, 0); }		*/

			html {
				margin: 0;
				padding: 0;
				height: 100%;
			}

			body {
				margin: 0;
				padding: 0;
				height: 100%;
				position: relative;
			}

			canvas {
				display: block;
				position: relative;
				height: 100%;
				width: 100%;
			}
		</style>

		<script type="text/javascript" src="engine/spine-runtime/pixi/bin/pixi.dev.js"></script>
		<script type="text/javascript" src="engine/scene.js"></script>
		<script type="text/javascript" src="engine/object.js"></script>

		<script type="text/javascript">
			window.onload = function() {

				var assetsToLoader = [
					"assets/models/spineboy/spineboy.json",
					"assets/models/spineboy/spineboy.anim",

					"assets/models/dragon/dragon.json",
					"assets/models/dragon/dragon.anim",

					"assets/models/goblins/images/goblin/goblin.json",
					"assets/models/goblins/images/goblin/goblin.anim",

					"assets/background/lvl1_1.png"
				];

				// create a new loader
				var loader = new PIXI.AssetLoader(assetsToLoader);

				// use callback
				loader.onComplete = function() {
					//console.log('loaded');


					var obj1 = obj().create({
							src: 'assets/background/lvl1_1.png',
							x: 0,
							y: 0,
							z: 10
						});

					var obj2 = obj().create({
							src: 'assets/models/spineboy/spineboy.anim',
							x: 600,
							y: 400,
							z: 20
						});

					var obj3 = obj().create({
							src: 'assets/models/dragon/dragon.anim',
							x: 400,
							y: 700,
							z: 30
						});

					var obj4 = obj().create({
							src: 'assets/models/goblins/images/goblin/goblin.anim',
							x: 300,
							y: 300,
							z: 40
						});

					var obj5 = obj().create({
							src: 'assets/models/spineboy/spineboy.anim',
							x: 200,
							y: 400,
							z: 50
						});

					var obj6 = obj().create({
							src: 'assets/models/goblins/images/goblin/goblin.anim',
							x: 350,
							y: 400,
							z: 60
						});


					scene
						.init({
							canvasId: 'view'
						})
						.addObj(obj1)
						.addObj(obj2)
						.addObj(obj4)
						.addObj(obj3)
						.addObj(obj5)
						.addObj(obj6);

					setInterval(function() {
						var objects = [obj2, obj3, obj4, obj5, obj6],
							planes = [20, 30, 40, 50, 60],
							index = planes[ Math.round( Math.random() * 4 ) ],
							index2 = objects[ Math.round( Math.random() * 4 ) ];


						index2.move({
							z: index
						})
						//console.log(index2, index);
						//console.log(Z.getZindex());
					}, 1000)

					 /*setTimeout(function() {
						obj6.move({
							z: 20
						})
						console.log(Z.getZindex());

						 setTimeout(function() {
							obj6.move({
								z: 60
							})
							console.log(Z.getZindex());
						}, 1000)
					}, 1000)*/

				}

				//begin load
				loader.load();

			}
		</script>

	</head>
	<body>
		<canvas id="view"></canvas>
	</body>
</html>